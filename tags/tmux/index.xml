<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>tmux on blog-ja.dtan4.net</title><link>https://dtan4.github.io/blog-ja/tags/tmux/</link><description>Recent content in tmux on blog-ja.dtan4.net</description><generator>Hugo -- gohugo.io</generator><language>ja-JP</language><copyright>Copyright &amp;copy; 2020 dtan4 All Rights Reserved</copyright><lastBuildDate>Wed, 07 Oct 2015 00:00:00 +0000</lastBuildDate><atom:link href="https://dtan4.github.io/blog-ja/tags/tmux/index.xml" rel="self" type="application/rss+xml"/><item><title>tmux で Prefix key が押されているかどうかを表示する</title><link>https://dtan4.github.io/blog-ja/posts/qiita-363e92525e7c5a16f3fc/</link><pubDate>Wed, 07 Oct 2015 00:00:00 +0000</pubDate><guid>https://dtan4.github.io/blog-ja/posts/qiita-363e92525e7c5a16f3fc/</guid><description>この記事はQiitaの記事をエクスポートしたものです。内容が古くなっている可能性があります。
tmux でペイン分割とかウィンドウ作成するときとかにキーバインドとして使う Prefix key (C-b とか C-t とか設定されてる) ですが、誤動作を防ぐためにいま Prefix key が押されているのかどうなのか視覚的に確認したいことがあります。
以下のように .tmux.conf を書くことで、Prefix key が押された時に Status line の色を下動画のように反転させられます。
set-option -g status-left '#[fg=cyan,bg=#303030]#{?client_prefix,#[reverse],} #H[#S] #[default]' (Prefix key は C-t に設定)
重要なのはこれ
#{?client_prefix,#[reverse],} .tmux.conf では ?&amp;lt;condition&amp;gt;,&amp;lt;true action&amp;gt;,&amp;lt;false action&amp;gt; の形で三項演算子をかけます。で、client_prefix は Prefix key が押されていたら 1 (true) になるというわけです。 今回は色を変えただけですが、押されている / いないときだけ何かしら文字を表示することももちろん可能です。
注意点があって、例えば Prefix key が押された時だけ黄色背景黒文字 (fg=black, bg=yellow) にしようとして
#{?client_prefix,#[fg=black,bg=yellow],} と愚直に書くと
のように表示がバグります。#[fg=black,bg=yellow] 内のコンマが三項演算子2つめのコンマと解釈されているようです。
こうしたいときは、#[] を分割すればよいです。
#{?client_prefix,#[fg=black]#[bg=yellow],} REF give a hint when press prefix key in tmux - Stack Overflow OpenBSD manual pages (tmux)</description></item><item><title>awscli + jq + peco + tmux-cssh を使って複数 EC2 インスタンスへ簡単 SSH</title><link>https://dtan4.github.io/blog-ja/posts/qiita-88545bbd2dcdb590b5a7/</link><pubDate>Mon, 28 Sep 2015 00:00:00 +0000</pubDate><guid>https://dtan4.github.io/blog-ja/posts/qiita-88545bbd2dcdb590b5a7/</guid><description>この記事はQiitaの記事をエクスポートしたものです。内容が古くなっている可能性があります。
TL;DR 必要なもの (awscli, jq, peco, tmux, tmux-cssh) をすべて入れた状態で
$ sh -c &amp;#34;tmux-cssh -i &amp;lt;ssh_key&amp;gt; -u &amp;lt;ssh_user&amp;gt; $(aws ec2 describe-instances | jq -r &amp;#39;.Reservations[] | .Instances[] | select(.State.Name != &amp;#34;terminated&amp;#34;) | select(has(&amp;#34;PublicIpAddress&amp;#34;)) | [.PublicIpAddress,.PrivateIpAddress,.State.Name,(.Tags[] | select(.Key == &amp;#34;Name&amp;#34;) | .Value // &amp;#34;&amp;#34;)] | join(&amp;#34;\t&amp;#34;)&amp;#39; | peco | awk &amp;#39;{ print $1 }&amp;#39; | tr &amp;#39;\n&amp;#39; &amp;#39; &amp;#39;)&amp;#34; とすることで、peco で EC2 インスタンスを選んで同時に SSH アクセスすることができます。
:warning: tmux 上で生活している方は、一度 tmux detach して tmux の外に出ないと tmux-cssh が実行できません。 また、ターミナル起動時に自動で tmux を立ち上げる設定は無効化しておく必要があります。</description></item></channel></rss>